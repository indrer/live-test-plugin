!function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=1)}([function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.escape=function(t,e){return String(t).replace(/["'`\\\b\f\n\r\t\u2028\u2029]/g,(function(t){if(e&&e.indexOf(t)>=0)return t;switch(t){case'"':case"'":case"`":case"\\":return"\\"+t;case"\b":return"\\b";case"\f":return"\\f";case"\n":return"\\n";case"\r":return"\\r";case"\t":return"\\t";case"\u2028":return"\\u2028";case"\u2029":return"\\u2029"}}))},e.unescape=function(t){return String(t).replace(/\\["'`\\bfnrt]|\\u2028|\\u2029/g,(function(t){switch(t){case'\\"':case"\\'":case"\\`":case"\\\\":return t[1];case"\\b":return"\b";case"\\f":return"\f";case"\\n":return"\n";case"\\r":return"\r";case"\\t":return"\t";case"\\u2028":return"\u2028";case"\\u2029":return"\u2029"}}))}},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function o(t,e,n){return e&&i(t.prototype,e),n&&i(t,n),t}n.r(e);var a=function(){function t(e){r(this,t),this.data=e,this.next=null}return o(t,[{key:"getNext",value:function(){return this.next}},{key:"getData",value:function(){return this.data}},{key:"addNext",value:function(t){this.next=t}}]),t}(),u=function(){function t(){r(this,t),this.head=null,this.tail=null,this.size=0}return o(t,[{key:"addNode",value:function(t){this.size++,null==this.head?(this.head=new a(t),this.tail=this.head):(this.tail.addNext(new a(t)),this.tail=this.tail.getNext())}},{key:"getSize",value:function(){return this.size}},{key:"getHeadNode",value:function(){return this.head}},{key:"toString",value:function(){if(null==this.head)return"";if(this.tail===this.head)return this.head.getData().toString();for(var t="",e=this.head;null!==e.getNext();)t=t+e.getData().toString()+"\n",e=e.getNext();return t+=e.getData().toString()}}]),t}(),c="visit",s="click",l="execute",f="input";function d(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.link=e}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return'visit "'.concat(this.link,'"')}}])&&d(e.prototype,n),r&&d(e,r),t}();function g(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var v=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sel=e.uniqsel,this.text=e.textcont}var e,n,r;return e=t,(n=[{key:"toString",value:function(){var t='click "'.concat(this.sel,'"');return 0===this.text.length?t:t+' with text "'.concat(this.text,'"')}}])&&g(e.prototype,n),r&&g(e,r),t}(),w=n(0),p=function(t){return Object(w.escape)(t,["`","'","\t","\n","\r"])};function m(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var b=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.text=void 0===e?"":p(e)}var e,n,r;return e=t,(n=[{key:"toString",value:function(){return this.text.includes("\n")?"execute {{\n".concat(this.text,"\n}}"):"execute {{ ".concat(this.text," }}")}}])&&m(e.prototype,n),r&&m(e,r),t}();function y(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var x=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.sel=e.uniqsel,this.text=e.textcont,this.inpt=void 0===n?"":n}var e,n,r;return e=t,(n=[{key:"toString",value:function(){var t='input "'.concat(p(this.inpt),'" to "').concat(this.sel,'"');return this.text.length>0&&(t+=' with text "'.concat(this.text,'"')),t}}])&&y(e.prototype,n),r&&y(e,r),t}();function S(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var k=function(){function t(e,n,r){switch(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.action=null,e){case c:this.action=new h(r);break;case s:this.action=new v(n);break;case l:this.action=new b(r);break;case f:this.action=new x(n,r);break;default:console.log("Something went wrong")}}var e,n,r;return e=t,(n=[{key:"getAction",value:function(){return this.action}},{key:"toString",value:function(){return this.action.toString()}}])&&S(e.prototype,n),r&&S(e,r),t}();function j(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var N=function(){function t(e,n,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.type=e,this.sel=n.uniqsel,this.text=n.textcont}var e,n,r;return e=t,(n=[{key:"toString",value:function(){var t="expect to ".concat(this.type.replace("-"," "),' "').concat(this.sel,'"');return 0===this.text.length?t:t+' with text "'.concat(this.text,'"')}}])&&j(e.prototype,n),r&&j(e,r),t}();function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var E=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.instructions=new u,n&&this.instructions.addNode(new h(e))}var e,n,r;return e=t,(n=[{key:"getSize",value:function(){return this.instructions.getSize()}},{key:"addAction",value:function(t,e,n){var r=new k(t,e,n);this.instructions.addNode(r)}},{key:"addAssertion",value:function(t,e,n){var r=new N(t,e,n);this.instructions.addNode(r)}},{key:"addVisit",value:function(t,e){var n=new h(t,e);this.instructions.addNode(n)}},{key:"toString",value:function(){return this.instructions.toString()+"\n"}}])&&C(e.prototype,n),r&&C(e,r),t}(),L=function(t){var e=[],n="";if(t.id)return{uniqsel:"#"+t.id,textcont:n};for(;null!==t.parentNode;){if(t.id){e.unshift("#"+t.id),e=[e[0],e[e.length-1]];break}0===e.length?(n="img"===t.tagName.toLowerCase()||0===t.childNodes.length?"":null===t.childNodes[0].nodeValue?"":p(t.childNodes[0].nodeValue.trim()),"img"===t.tagName.toLowerCase()?e.unshift("img[src='".concat(p(t.src),"']")):e.unshift(t.tagName.toLowerCase())):e.unshift(t.tagName.toLowerCase()),t=t.parentNode}return{uniqsel:e.join(" "),textcont:n}};var O=null===window.localStorage.getItem("wtest")||0===window.localStorage.getItem("wtest").length;O&&chrome.extension.sendMessage({action:"getTabId"},(function(t){window.localStorage.setItem("wtest-id",t.tabId)}));var P=new E(window.location.href,O),I=null,T=null,q=null;function A(t){t.stopPropagation();var e=L(t.target);if("clickreq"===I.subject)P.addAction(s,e,""),H("clicksel"),t.target.href&&(window.location.href=t.target.href);else if(t.target.addEventListener("click",M),"assertreq"===I.subject){var n=I.assertType;P.addAssertion(n,e,""),H("assertsel")}else if("havereq"===I.subject){var r=I.assertType;P.addAssertion(r,e,""),H("havesel")}else if("visitreq"===I.subject){if(t.target.href){var i=t.target.href;P.addAction(c,"",i)}else alert("The element does not contain any links!");H("visitsel")}D(t),document.removeEventListener("mousedown",A),document.removeEventListener("mouseover",_),document.removeEventListener("mouseout",D)}function z(t){q=L(t.target),H("inputstr",T=t.target.value)}function M(t){t.preventDefault(),t.target.removeEventListener("click",M)}function _(t){t.stopPropagation(),t.target.style.outline="2px solid red","img"===t.target.tagName.toLowerCase()?t.target.parentNode.appendChild(V(t)):t.target.appendChild(V(t))}function D(t){t.target.style.outline="";var e=null;"img"===t.target.tagName.toLowerCase()?(e=t.target.parentNode.querySelectorAll(".selector-text-wtest")[0],t.target.parentNode.removeChild(e)):(e=t.target.querySelectorAll(".selector-text-wtest")[0],t.target.removeChild(e))}function V(t){var e=t.target.offsetHeight,n=window.getComputedStyle(t.target,null).getPropertyValue("font-size"),r=parseFloat(n),i=L(t.target).uniqsel,o=document.createElement("p");return o.style="position: absolute;\n  margin-top: -".concat(e+5,"px;\n  background: red; \n  font-size: ").concat(.8*r>14?14:Math.floor(.8*r),"px; \n  font-weight: normal; \n  color: white;\n  padding: 0px;\n  z-index: 9999;"),o.classList.add("selector-text-wtest"),o.textContent=i,o}function H(t,e){chrome.runtime.sendMessage({from:"main",subject:t,inputString:e})}chrome.runtime.onMessage.addListener((function(t,e,n){chrome.extension.sendMessage({action:"getTabId"},(function(e){if(e.tabId==window.localStorage.getItem("wtest-id")){if(I=t,"testwin"===t.from&&"testfin"!==t.subject)if("executereq"===t.subject){var r=I.executeString;P.addAction(l,"",r),H("executesel")}else"inputreq"===t.subject?document.addEventListener("input",z):"inputfin"===t.subject?(document.removeEventListener("input",z),P.addAction(f,q,T),T=null,q=null):(document.addEventListener("mouseover",_),document.addEventListener("mouseout",D),document.addEventListener("mousedown",A));else"testwin"===t.from&&"testfin"===t.subject&&(i="test.wtest",o=(null===window.localStorage.getItem("wtest")?"":window.localStorage.getItem("wtest"))+P.toString().substring(0,P.toString().length-1),(a=document.createElement("a")).href="data:text/plain;charset=utf-8,"+encodeURIComponent(o),a.download=i,a.click(),window.localStorage.removeItem("wtest"),window.localStorage.removeItem("wtest-id"),P=new E(window.location.href,!0));n()}var i,o,a}))})),window.addEventListener("beforeunload",(function(t){P.getSize()>1&&window.localStorage.setItem("wtest",(null===window.localStorage.getItem("wtest")?"":window.localStorage.getItem("wtest"))+P.toString())}))}]);